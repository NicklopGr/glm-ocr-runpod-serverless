# RTX A40 preset (RunPod A40 is typically 48GB VRAM)
# Full layout mode (PP-DocLayoutV3) + JSON+Markdown output.

# RunPod handler concurrency
WORKER_MAX_CONCURRENCY=1
DOWNLOAD_CONCURRENCY=16
MAX_PAGES_PER_JOB=128

# Input normalization
IMAGE_MAX_SIDE=2200
IMAGE_JPEG_QUALITY=90

# Handler response controls
RETURN_CROP_IMAGES_DEFAULT=false
MAX_CROP_IMAGES=200
GLMOCR_PARSE_TIMEOUT_SECONDS=1800
GLMOCR_LOG_LEVEL=INFO

# vLLM model serving
MODEL_NAME=zai-org/GLM-OCR
MODEL_REVISION=e9134f400acad80346162536e043def285fa1022
SERVED_MODEL_NAME=glm-ocr
VLLM_HOST=0.0.0.0
VLLM_PORT=8080
VLLM_DTYPE=float16
TRUST_REMOTE_CODE=true
GPU_MEMORY_UTILIZATION=0.92
MAX_MODEL_LEN=16384
MAX_NUM_SEQS=96
MAX_NUM_BATCHED_TOKENS=32768
LIMIT_MM_PER_PROMPT=
SPECULATIVE_CONFIG=
VLLM_HEALTH_TIMEOUT=420

# GLM-OCR pipeline (official full layout style)
GLMOCR_CONFIG_PATH=/app/glmocr.config.yaml
GLMOCR_ENABLE_LAYOUT=true
GLMOCR_OUTPUT_FORMAT=both
GLMOCR_MAX_WORKERS=16
GLMOCR_CONNECTION_POOL_SIZE=128
GLMOCR_PAGE_MAXSIZE=100
GLMOCR_REGION_MAXSIZE=800
GLMOCR_MAX_TOKENS_PER_PAGE=4096
GLMOCR_TEMPERATURE=0.01
GLMOCR_TOP_P=0.9
GLMOCR_DEFAULT_PROMPT=Recognize all text, formulas, and tables in the document.
GLMOCR_CONNECT_TIMEOUT=30
GLMOCR_REQUEST_TIMEOUT=180
GLMOCR_RETRY_MAX_ATTEMPTS=3
GLMOCR_RETRY_BACKOFF_BASE_SECONDS=0.75

# Layout detector
GLMOCR_LAYOUT_MODEL_DIR=PaddlePaddle/PP-DocLayoutV3_safetensors
GLMOCR_LAYOUT_THRESHOLD=0.3
GLMOCR_LAYOUT_BATCH_SIZE=1
GLMOCR_LAYOUT_WORKERS=1
GLMOCR_LAYOUT_CUDA_VISIBLE_DEVICES=0
